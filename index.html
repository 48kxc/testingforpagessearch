<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>48 Searcher</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap');
body, html {
margin: 0; padding: 0; height: 100%;
background: #1a0b3a;
color: #ddd;
font-family: 'Roboto Mono', monospace;
overflow-x: hidden;
position: relative;
}
body::before {
content: "";
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background: radial-gradient(circle, #fff 1px, transparent 1px) repeat;
background-size: 20px 20px;
opacity: 0.12;
animation: starsMove 60s linear infinite;
z-index: 0;
}
@keyframes starsMove {
from { background-position: 0 0; }
to { background-position: 1000px 1000px; }
}
#container {
max-width: 700px;
background: #2b1a58;
margin: 50px auto 80px;
padding: 30px 40px;
border-radius: 20px;
box-shadow:
0 0 20px 3px #451f9a,
inset 0 0 20px 1px #6c4dc9;
position: relative;
z-index: 2;
display: none; /* hidden until login */
}
h1 {
text-align: center;
font-weight: 600;
font-size: 3em;
color: #a27eff;
margin-bottom: 30px;
text-shadow: 0 0 5px #bf9fff;
}
label {
display: block;
margin-top: 18px;
margin-bottom: 6px;
font-weight: 600;
color: #d2c9f7;
}
input[type=text], select {
width: 100%;
padding: 10px 15px;
border-radius: 12px;
border: 2px solid #5a3e9c;
background: #3f2e6a;
color: #ddd;
font-size: 1.1em;
box-shadow: inset 0 0 6px #6a54ac;
transition: border-color 0.3s ease;
}
input[type=text]:focus, select:focus {
outline: none;
border-color: #b79bff;
box-shadow: 0 0 10px #b79bff;
background: #4b3a80;
}
button {
margin-top: 25px;
width: 100%;
background: linear-gradient(145deg, #8362ff, #4a31bf);
color: #eee;
font-weight: 700;
font-size: 1.2em;
padding: 12px;
border: none;
border-radius: 14px;
cursor: pointer;
box-shadow:
0 5px 15px #4a31bf,
inset 0 -3px 8px #8362ff;
transition: background 0.4s ease;
}
button:hover {
background: linear-gradient(145deg, #9f7dff, #6328e1);
}
textarea {
margin-top: 25px;
width: 100%;
height: 150px;
background: #3f2e6a;
border-radius: 12px;
border: 2px solid #5a3e9c;
color: #ccc;
padding: 15px;
font-family: 'Roboto Mono', monospace;
font-size: 1.1em;
box-shadow: inset 0 0 8px #6a54ac;
resize: none;
}
#adminBtn {
position: fixed;
top: 20px;
right: 20px;
background: #4b3a80;
color: #ddd;
border: none;
padding: 12px 18px;
border-radius: 16px;
font-weight: 700;
cursor: pointer;
box-shadow:
0 4px 10px #2f235d,
inset 0 -2px 5px #6c4dc9;
transition: background 0.3s ease;
z-index: 10;
width: auto;
display: none; /* hidden until login */
}
#adminBtn:hover {
background: #633ec9;
}
#adminPanel {
position: fixed;
top: 50%; left: 50%;
transform: translate(-50%, -50%);
background: #2b1a58;
border-radius: 20px;
padding: 30px 40px;
width: 400px;
box-shadow:
0 0 30px 5px #6c4dc9,
inset 0 0 15px #451f9a;
display: none;
z-index: 100;
color: #ddd;
}
#adminPanel input[type=password], #adminPanel input[type=text] {
width: 100%;
padding: 12px 15px;
font-size: 1.1em;
border-radius: 14px;
border: 2px solid #5a3e9c;
background: #3f2e6a;
color: #ddd;
box-shadow: inset 0 0 6px #6a54ac;
margin-bottom: 15px;
}
#adminPanel button {
width: 100%;
background: #633ec9;
padding: 12px;
border-radius: 14px;
font-weight: 700;
box-shadow: 0 5px 15px #4a31bf;
}
#keyGenerator {
margin-top: 20px;
}
#newKey {
margin-top: 12px;
font-family: 'Roboto Mono', monospace;
font-weight: 700;
font-size: 1.1em;
color: #b79bff;
word-break: break-word;
}
#workingKeys {
margin-top: 25px;
padding: 15px;
background: #3f2e6a;
border-radius: 12px;
border: 2px solid #5a3e9c;
color: #ccc;
font-size: 0.95em;
max-height: 200px;
overflow-y: auto;
box-shadow: inset 0 0 8px #6a54ac;
}
#workingKeys ul {
list-style: none;
padding-left: 0;
}
#workingKeys li {
margin-bottom: 6px;
word-break: break-all;
display: flex;
justify-content: space-between;
}
#workingKeys .expireTime {
font-style: italic;
font-size: 0.85em;
color: #a99fff;
margin-left: 8px;
white-space: nowrap;
}
#errorMessage, #keyErrorMessage {
color: #ff6f6f;
font-weight: 700;
margin-bottom: 10px;
text-align: center;
}
#loginOverlay {
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
background: rgba(0,0,0,0.85);
display: flex;
justify-content: center;
align-items: center;
z-index: 9999;
flex-direction: column;
padding: 20px;
color: #ddd;
font-family: 'Roboto Mono', monospace;
}
#loginOverlay input {
font-size: 1.3em;
padding: 12px 15px;
border-radius: 14px;
border: 2px solid #5a3e9c;
background: #3f2e6a;
color: #ddd;
box-shadow: inset 0 0 6px #6a54ac;
margin-bottom: 15px;
width: 320px;
max-width: 90vw;
}
#loginOverlay button {
font-size: 1.2em;
padding: 12px 15px;
border-radius: 14px;
border: none;
background: linear-gradient(145deg, #8362ff, #4a31bf);
color: #eee;
font-weight: 700;
cursor: pointer;
width: 320px;
max-width: 90vw;
box-shadow:
0 5px 15px #4a31bf,
inset 0 -3px 8px #8362ff;
transition: background 0.4s ease;
}
#loginOverlay button:hover {
background: linear-gradient(145deg, #9f7dff, #6328e1);
}
</style>
</head>
<body>

<div id="loginOverlay">
<h2>Please enter your Access Key or Admin Password</h2>
<input type="text" id="accessKeyInput" placeholder="Access Key or Admin Password" autocomplete="off" autocapitalize="none" />
<div id="keyErrorMessage"></div>
<button id="submitAccessKeyBtn" type="button">Submit</button>
</div>

<button id="adminBtn" type="button">Admin Panel</button>

<div id="adminPanel" aria-modal="true" role="dialog" aria-labelledby="adminPanelTitle" aria-hidden="true">
<h2 id="adminPanelTitle">Admin Panel Login</h2>
<input type="password" id="adminPassword" placeholder="Enter admin password" autocomplete="off" autocapitalize="none" />
<button id="loginAdmin" type="button">Login</button>

<div id="keyGenerator" style="display:none;">
<h3>Generate New Key</h3>
<label for="keyDuration">Expiration (minutes):</label>
<select id="keyDuration">
<option value="15">15</option>
<option value="30" selected>30</option>
<option value="60">60</option>
<option value="120">120</option>
<option value="240">240</option>
<option value="420">420 (7 hours)</option>
</select>
<button id="generateKeyBtn" type="button">Generate Key</button>
<p>New Key: <span id="newKey"></span></p>

<h3>Valid Keys</h3>
<div id="workingKeys"><ul></ul></div>
<button id="refreshKeysBtn" type="button">Refresh Key List</button>
</div>
</div>

<div id="container">
<h1>48 Searcher - Advanced Google Queries</h1>
<label for="keyword">Keyword</label>
<input type="text" id="keyword" autocomplete="off" autocapitalize="none" />
<label for="domainExt">Domain Extension (e.g., com, org, gov)</label>
<input type="text" id="domainExt" autocomplete="off" autocapitalize="none" />
<label for="operator">Search Operator</label>
<select id="operator">
<option value="site:">site:</option>
<option value="inurl:">inurl:</option>
<option value="intitle:">intitle:</option>
<option value="allintext:">allintext:</option>
<option value="allinurl:">allinurl:</option>
</select>
<button id="generateBtn" type="button">Generate Query</button>
<textarea id="resultArea" readonly></textarea>
</div>

<script type="module">
document.addEventListener("DOMContentLoaded", () => {
  // Firebase configuration - replace with your own
  import("https://www.gstatic.com/firebasejs/9.24.0/firebase-app.js").then(({initializeApp}) => {
    import("https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore.js").then((firestore) => {
      const {getFirestore, collection, addDoc, query, where, getDocs, Timestamp} = firestore;

      const firebaseConfig = {
        apiKey: "AIzaSyDkU4W01OimygxLlEXBhqrba3PglcV2224",
        authDomain: "searcher-key-sys.firebaseapp.com",
        projectId: "searcher-key-sys",
        storageBucket: "searcher-key-sys.firebasestorage.app",
        messagingSenderId: "500491200168",
        appId: "1:500491200168:web:91ae88fa17f8a8bb6f849d"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const keysCollection = collection(db, "accessKeys");

      const MASTER_KEY = "48ontop2323";
      const ADMIN_PASSWORD = "48secret48";

      const loginOverlay = document.getElementById("loginOverlay");
      const accessKeyInput = document.getElementById("accessKeyInput");
      const submitAccessKeyBtn = document.getElementById("submitAccessKeyBtn");
      const keyErrorMessage = document.getElementById("keyErrorMessage");

      const container = document.getElementById("container");
      const adminBtn = document.getElementById("adminBtn");
      const adminPanel = document.getElementById("adminPanel");
      const adminPasswordInput = document.getElementById("adminPassword");
      const loginAdminBtn = document.getElementById("loginAdmin");

      const keyGeneratorSection = document.getElementById("keyGenerator");
      const keyDurationSelect = document.getElementById("keyDuration");
      const generateKeyBtn = document.getElementById("generateKeyBtn");
      const newKeySpan = document.getElementById("newKey");
      const workingKeysDiv = document.getElementById("workingKeys");
      const workingKeysList = workingKeysDiv.querySelector("ul");
      const refreshKeysBtn = document.getElementById("refreshKeysBtn");

      const keywordInput = document.getElementById("keyword");
      const domainExtInput = document.getElementById("domainExt");
      const operatorSelect = document.getElementById("operator");
      const generateBtn = document.getElementById("generateBtn");
      const resultArea = document.getElementById("resultArea");

      let adminLoggedIn = false;

      async function checkKeyValid(inputKey) {
        if (inputKey === MASTER_KEY) return true;

        const q = query(keysCollection, where("key", "==", inputKey));
        const snapshot = await getDocs(q);
        if (snapshot.empty) return false;

        const nowDate = new Date();

        for (const doc of snapshot.docs) {
          const data = doc.data();
          if (data.expireAt && data.expireAt.toDate() > nowDate) {
            return true;
          }
        }
        return false;
      }

      function formatTimestamp(ts) {
        if (!ts) return "-";
        const date = ts.toDate();
        return date.toLocaleString("en-US", { hour12: false });
      }

      async function loadWorkingKeys() {
        workingKeysList.innerHTML = '';
        const q = query(keysCollection, where("expireAt", ">=", Timestamp.now()));
        const snapshot = await getDocs(q);

        const nowDate = new Date();
        let foundValid = false;

        if (snapshot.empty) {
          workingKeysList.innerHTML = '<li>No valid keys found.</li>';
        } else {
          snapshot.forEach(doc => {
            const data = doc.data();
            if (data.expireAt && data.expireAt.toDate() > nowDate) {
              foundValid = true;
              const expFormatted = formatTimestamp(data.expireAt);
              const li = document.createElement("li");
              li.innerHTML = `<span>${data.key}</span><span class="expireTime">Expires at: ${expFormatted}</span>`;
              workingKeysList.appendChild(li);
            }
          });
          if (!foundValid) {
            workingKeysList.innerHTML = '<li>No valid keys found.</li>';
          }
        }
      }

      async function generateNewKey() {
        const durationMinutes = parseInt(keyDurationSelect.value, 10);
        if (!durationMinutes || durationMinutes <= 0) return;

        const now = new Date();
        const expireAt = Timestamp.fromDate(new Date(now.getTime() + durationMinutes * 60 * 1000));
        const newKeyVal = Math.random().toString(36).substring(2, 12);

        try {
          await addDoc(keysCollection, {
            key: newKeyVal,
            expireAt: expireAt
          });
          newKeySpan.textContent = newKeyVal;
          await loadWorkingKeys();
        } catch (err) {
          newKeySpan.textContent = "Error creating key";
          console.error(err);
        }
      }

      async function adminLogin() {
        const pw = adminPasswordInput.value.trim();
        if (pw === ADMIN_PASSWORD) {
          adminLoggedIn = true;
          keyGeneratorSection.style.display = "block";
          adminPasswordInput.value = "";
          adminPasswordInput.disabled = true;
          loginAdminBtn.disabled = true;
          await loadWorkingKeys();
        } else {
          alert("Wrong admin password");
        }
      }

      function showAdminPanel() {
        adminPanel.style.display = "block";
        adminPanel.setAttribute("aria-hidden", "false");
        adminPasswordInput.focus();
      }

      function hideAdminPanel() {
        adminPanel.style.display = "none";
        adminPanel.setAttribute("aria-hidden", "true");
      }

      submitAccessKeyBtn.addEventListener("click", async () => {
        keyErrorMessage.textContent = "";
        const key = accessKeyInput.value.trim();
        if (!key) {
          keyErrorMessage.textContent = "Please enter a key or password.";
          return;
        }
        submitAccessKeyBtn.disabled = true;
        const valid = await checkKeyValid(key);
        submitAccessKeyBtn.disabled = false;
        if (valid) {
          loginOverlay.style.display = "none";
          container.style.display = "block";
          if (key === ADMIN_PASSWORD || key === MASTER_KEY) {
            adminBtn.style.display = "block";
          }
        } else {
          keyErrorMessage.textContent = "Invalid or expired key.";
        }
      });

      adminBtn.addEventListener("click", () => {
        showAdminPanel();
      });

      loginAdminBtn.addEventListener("click", async () => {
        await adminLogin();
      });

      generateKeyBtn.addEventListener("click", async () => {
        await generateNewKey();
      });

      refreshKeysBtn.addEventListener("click", async () => {
        await loadWorkingKeys();
      });

      generateBtn.addEventListener("click", () => {
        const keyword = keywordInput.value.trim();
        const domainExt = domainExtInput.value.trim();
        const operator = operatorSelect.value;

        if (!keyword) {
          alert("Please enter a keyword.");
          return;
        }

        let queryStr = "";

        if (operator === "site:" && domainExt) {
          queryStr = `${operator}*.${domainExt} ${keyword}`;
        } else if (operator !== "site:") {
          queryStr = `${operator}${keyword}`;
        } else {
          queryStr = keyword;
        }

        resultArea.value = queryStr;
      });
    });
  });
});
</script>

</body>
</html>
