<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>48 Searcher</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap');
  body, html {
    margin: 0; padding: 0; height: 100%;
    background: #1a0b3a;
    color: #ddd;
    font-family: 'Roboto Mono', monospace;
    overflow-x: hidden;
    position: relative;
  }
  /* Starry background */
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(circle, #fff 1px, transparent 1px) repeat;
    background-size: 20px 20px;
    opacity: 0.12;
    animation: starsMove 60s linear infinite;
    z-index: 0;
  }
  @keyframes starsMove {
    from { background-position: 0 0; }
    to { background-position: 1000px 1000px; }
  }

  /* Container */
  #container {
    max-width: 700px;
    background: #2b1a58;
    margin: 50px auto 80px;
    padding: 30px 40px;
    border-radius: 20px;
    box-shadow:
      0 0 20px 3px #451f9a,
      inset 0 0 20px 1px #6c4dc9;
    position: relative;
    z-index: 2;
  }

  h1 {
    text-align: center;
    font-weight: 600;
    font-size: 3em;
    color: #a27eff;
    margin-bottom: 30px;
    text-shadow: 0 0 5px #bf9fff;
  }

  label {
    display: block;
    margin-top: 18px;
    margin-bottom: 6px;
    font-weight: 600;
    color: #d2c9f7;
  }

  input[type=text], select {
    width: 100%;
    padding: 10px 15px;
    border-radius: 12px;
    border: 2px solid #5a3e9c;
    background: #3f2e6a;
    color: #ddd;
    font-size: 1.1em;
    box-shadow: inset 0 0 6px #6a54ac;
    transition: border-color 0.3s ease;
  }
  input[type=text]:focus, select:focus {
    outline: none;
    border-color: #b79bff;
    box-shadow: 0 0 10px #b79bff;
    background: #4b3a80;
  }

  button {
    margin-top: 25px;
    width: 100%;
    background: linear-gradient(145deg, #8362ff, #4a31bf);
    color: #eee;
    font-weight: 700;
    font-size: 1.2em;
    padding: 12px;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    box-shadow:
      0 5px 15px #4a31bf,
      inset 0 -3px 8px #8362ff;
    transition: background 0.4s ease;
  }
  button:hover {
    background: linear-gradient(145deg, #9f7dff, #6328e1);
  }

  textarea {
    margin-top: 25px;
    width: 100%;
    height: 150px;
    background: #3f2e6a;
    border-radius: 12px;
    border: 2px solid #5a3e9c;
    color: #ccc;
    padding: 15px;
    font-family: 'Roboto Mono', monospace;
    font-size: 1.1em;
    box-shadow: inset 0 0 8px #6a54ac;
    resize: none;
  }

  /* Admin Panel Button */
  #adminBtn {
    position: fixed;
    top: 20px;
    right: 20px;
    background: #4b3a80;
    color: #ddd;
    border: none;
    padding: 12px 18px;
    border-radius: 16px;
    font-weight: 700;
    cursor: pointer;
    box-shadow:
      0 4px 10px #2f235d,
      inset 0 -2px 5px #6c4dc9;
    transition: background 0.3s ease;
    z-index: 10;
  }
  #adminBtn:hover {
    background: #633ec9;
  }

  /* Admin Panel Modal */
  #adminPanel {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #2b1a58;
    border-radius: 20px;
    padding: 30px 40px;
    width: 320px;
    box-shadow:
      0 0 30px 5px #6c4dc9,
      inset 0 0 15px #451f9a;
    display: none;
    z-index: 100;
  }
  #adminPanel input[type=password] {
    width: 100%;
    padding: 12px 15px;
    font-size: 1.1em;
    border-radius: 14px;
    border: 2px solid #5a3e9c;
    background: #3f2e6a;
    color: #ddd;
    box-shadow: inset 0 0 6px #6a54ac;
    margin-bottom: 15px;
  }
  #adminPanel button {
    width: 100%;
    background: #633ec9;
    padding: 12px;
    border-radius: 14px;
    font-weight: 700;
    box-shadow: 0 5px 15px #4a31bf;
  }
  #keyGenerator {
    margin-top: 20px;
  }
  #newKey {
    margin-top: 12px;
    font-family: 'Roboto Mono', monospace;
    font-weight: 700;
    font-size: 1.1em;
    color: #b79bff;
    word-break: break-word;
  }
</style>
</head>
<body>

<!-- Admin Panel Button -->
<button id="adminBtn">Admin Panel</button>

<!-- Admin Panel -->
<div id="adminPanel">
  <input type="password" id="adminPassword" placeholder="Enter admin password" />
  <button id="loginAdmin">Login</button>
  <div id="keyGenerator" style="display:none;">
    <button id="generateKey">Generate Access Key</button>
    <p id="newKey"></p>
  </div>
</div>

<div id="container">
  <h1>48 Searcher</h1>

  <!-- Advanced Google Search UI -->
  <label for="keywords">Keywords (space separated)</label>
  <input type="text" id="keywords" placeholder="e.g. openAI chatbot" />

  <label for="excludeWords">Exclude Words (space separated)</label>
  <input type="text" id="excludeWords" placeholder="e.g. tutorial example" />

  <label for="siteSearch">Site Search (optional domain or leave blank)</label>
  <input type="text" id="siteSearch" placeholder="e.g. .com, .pages.dev, or example.com" />

  <label for="fileType">File Type (optional)</label>
  <input type="text" id="fileType" placeholder="e.g. pdf, docx, ppt" />

  <label for="searchExact">Exact Phrase</label>
  <input type="text" id="searchExact" placeholder="e.g. &quot;machine learning&quot;" />

  <label for="intitle">Words in Title</label>
  <input type="text" id="intitle" placeholder="e.g. security" />

  <label for="inurl">Words in URL</label>
  <input type="text" id="inurl" placeholder="e.g. login" />

  <label for="excludeTerms">Exclude Terms</label>
  <input type="text" id="excludeTerms" placeholder="e.g. ads, sponsored" />

  <button id="generateBtn">Generate Search Query</button>

  <textarea id="result" readonly placeholder="Your advanced search query will appear here..."></textarea>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>

<script>
  // Firebase config - fill with your own
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Elements
  const adminBtn = document.getElementById('adminBtn');
  const adminPanel = document.getElementById('adminPanel');
  const loginAdminBtn = document.getElementById('loginAdmin');
  const adminPasswordInput = document.getElementById('adminPassword');
  const keyGenerator = document.getElementById('keyGenerator');
  const generateKeyBtn = document.getElementById('generateKey');
  const newKeyDisplay = document.getElementById('newKey');

  // Admin password constants
  const MASTER_KEY = "48ontop2323";

  // Show admin panel modal
  adminBtn.addEventListener('click', () => {
    adminPanel.style.display = 'block';
    adminPasswordInput.value = '';
    keyGenerator.style.display = 'none';
    newKeyDisplay.textContent = '';
  });

  // Admin login check
  loginAdminBtn.addEventListener('click', () => {
    const input = adminPasswordInput.value.trim();
    if (input === MASTER_KEY) {
      keyGenerator.style.display = 'block';
      alert('Admin access granted!');
    } else {
      alert('Incorrect admin password.');
    }
  });

  // Generate a random unique key string
  function generateUniqueKey() {
    return 'key-' + Math.random().toString(36).substring(2, 11);
  }

  // Store generated key in Firestore with 7-hour expiry
  generateKeyBtn.addEventListener('click', async () => {
    const key = generateUniqueKey();
    const expireAt = new Date(Date.now() + 7 * 60 * 60 * 1000); // 7 hours from now

    try {
      await db.collection('accessKeys').doc(key).set({
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        expireAt: firebase.firestore.Timestamp.fromDate(expireAt)
      });
      newKeyDisplay.textContent = `New Access Key: ${key} (Expires in 7 hours)`;
    } catch (error) {
      console.error('Error generating key:', error);
      alert('Failed to generate key. See console.');
    }
  });

  // === Advanced Search Generator ===
  const generateBtn = document.getElementById('generateBtn');
  const result = document.getElementById('result');

  function sanitizeInput(str) {
    return str.trim();
  }

  generateBtn.addEventListener('click', () => {
    const keywords = sanitizeInput(document.getElementById('keywords').value);
    const excludeWords = sanitizeInput(document.getElementById('excludeWords').value);
    const siteSearch = sanitizeInput(document.getElementById('siteSearch').value);
    const fileType = sanitizeInput(document.getElementById('fileType').value);
    const searchExact = sanitizeInput(document.getElementById('searchExact').value);
    const intitle = sanitizeInput(document.getElementById('intitle').value);
    const inurl = sanitizeInput(document.getElementById('inurl').value);
    const excludeTerms = sanitizeInput(document.getElementById('excludeTerms').value);

    let queryParts = [];

    if (keywords) queryParts.push(keywords.split(/\s+/).map(w => `"${w}"`).join(' '));
    if (searchExact) queryParts.push(`"${searchExact.replace(/"/g, '')}"`);
    if (excludeWords) queryParts.push(excludeWords.split(/\s+/).map(w => `-${w}`).join(' '));
    if (siteSearch) queryParts.push(`site:${siteSearch}`);
    if (fileType) queryParts.push(`filetype:${fileType}`);
    if (intitle) queryParts.push(`intitle:${intitle}`);
    if (inurl) queryParts.push(`inurl:${inurl}`);
    if (excludeTerms) queryParts.push(excludeTerms.split(/\s+/).map(w => `-${w}`).join(' '));

    const finalQuery = queryParts.join(' ');
    result.value = finalQuery;
  });

  // -- Optional: You can add access control for site usage by keys here if needed --
  // For example, prompt user to enter a key, then verify it against Firebase OR check for MASTER_KEY.
</script>

</body>
</html>
